{{ define "main" }}
<div class="home">
  <section class="hero">
    <h1>{{ .Site.Title }}</h1>
    <p>{{ .Site.Params.description }}</p>
  </section>

  <section class="recent-posts">
    <h2>Recent Posts</h2>
    <div class="posts-list">
      {{ range first 5 (where .Site.RegularPages "Section" "posts") }}
        <article class="post-summary">
          <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
          <div class="post-meta">
            <time>{{ .Date.Format "January 2, 2006" }}</time>
            {{ with .Params.location }}
              <span class="location">{{ delimit . " > " }}</span>
            {{ end }}
            {{ with .Params.trip }}
              {{ with $.Site.GetPage (printf "/trips/%s" .) }}
                <span class="trip-link">
                  <a href="{{ .Permalink }}">{{ .Title }}</a>
                </span>
              {{ end }}
            {{ end }}
          </div>
          {{ with .Summary }}
            <p>{{ . }}</p>
          {{ end }}
          <a href="{{ .Permalink }}" class="read-more">Read more →</a>
        </article>
      {{ end }}
    </div>
    <a href="/posts/" class="view-all">View all posts →</a>
  </section>

  <section class="trips-overview">
    <h2>My Trips</h2>
    <div class="trips-grid">
      {{ range (where .Site.RegularPages "Section" "trips") }}
        <article class="trip-card">
          <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
          {{ with .Params.start_date }}
            <div class="trip-dates">
              {{ dateFormat "January 2006" . }}
              {{ with $.Params.end_date }}
                - {{ dateFormat "January 2006" . }}
              {{ end }}
            </div>
          {{ end }}
          {{ with .Params.countries }}
            <div class="trip-countries">
              {{ range first 3 . }}
                <span class="country-tag">{{ . }}</span>
              {{ end }}
            </div>
          {{ end }}
          {{ with .Params.stats }}
            <div class="trip-stats">
              {{ with .entries }}{{ . }} entries{{ end }}
              {{ with .photos }} • {{ . }} photos{{ end }}
            </div>
          {{ end }}
          <a href="{{ .Permalink }}" class="read-more">View Trip →</a>
        </article>
      {{ end }}
    </div>
  </section>
</div>
{{ end }}
