{{ define "main" }}
<article class="trip-overview">
  <header>
    <h1>{{ .Title }}</h1>
    {{ with .Params.start_date }}
      <div class="trip-dates">
        {{ dateFormat "January 2, 2006" . }}
        {{ with $.Params.end_date }}
          - {{ dateFormat "January 2, 2006" . }}
        {{ end }}
      </div>
    {{ end }}

    {{ with .Params.countries }}
      <div class="trip-countries">
        <strong>Countries:</strong>
        {{ range . }}
          <span class="country-tag">{{ . }}</span>
        {{ end }}
      </div>
    {{ end }}
  </header>

  <div class="trip-description">
    {{ .Content }}
  </div>

  <section class="trip-posts">
    <h2>Blog Entries ({{ len .Params.posts }})</h2>
    <div class="posts-list">
      {{ range .Params.posts }}
        {{ with $.Site.GetPage . }}
          <article class="post-summary">
            <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
            <div class="post-meta">
              <time>{{ .Date.Format "January 2, 2006" }}</time>
              {{ with .Params.location }}
                <span class="location">{{ delimit . " > " }}</span>
              {{ end }}
            </div>
            {{ with .Summary }}
              <p>{{ . }}</p>
            {{ end }}
          </article>
        {{ end }}
      {{ end }}
    </div>
  </section>

  {{ with .Params.stats }}
    <aside class="trip-stats">
      <h3>Trip Statistics</h3>
      <ul>
        {{ with .entries }}<li>Blog Entries: {{ . }}</li>{{ end }}
        {{ with .photos }}<li>Photos: {{ . }}</li>{{ end }}
        {{ with .words }}<li>Words Written: {{ . }}</li>{{ end }}
      </ul>
    </aside>
  {{ end }}
</article>
{{ end }}
